<div class="{{ column | default: 'col-12' }} mb-4">
  <div class="card shadow-sm product-card {% if horizontal_layout %}product-card-horizontal{% endif %}">
    <div class="row g-0">
      <!-- Product Image -->
      <div class="{% if horizontal_layout %}col-md-4{% else %}col-12{% endif %}">
        <a href="{{ product.url }}" class="text-decoration-none">
          {% if product.featured_image != blank %}
            <div class="image-container position-relative h-100">
              <img
                src="{{ product.featured_image | img_url:'medium' }}"
                class="img-fluid rounded-start featured-img"
                alt="{{ product.title }}"
                loading="lazy"
              >
              {% if product.images.size > 1 and show_second_img %}
                <img
                  src="{{ product.images[1] | img_url:'medium' }}"
                  class="img-fluid rounded-start second-img"
                  alt="{{ product.title }}"
                  loading="lazy"
                >
              {% endif %}

              <!-- Badges -->
              {% if product.tags contains 'new' %}
                <span class="badge badge-new">New</span>
              {% endif %}
              {% if product.compare_at_price > product.price %}
                <span class="badge badge-sale">Sale</span>
              {% endif %}
            </div>
          {% endif %}
        </a>
      </div>
      
      <div class="{% if horizontal_layout %}col-md-8{% else %}col-12{% endif %}">
        <div class="card-body d-flex flex-column h-100">
          <div class="d-flex justify-content-between align-items-start mb-2">
            <!-- Product Title -->
            <h5 class="card-title">
              <a href="{{ product.url }}" class="text-dark text-decoration-none">
                {{ product.title }}
              </a>
            </h5>
            
            <!-- Price -->
            <div class="product-price-container">
              {% render 'price', product: product %}
            </div>
          </div>
          
          <!-- Vendor -->
          {% if show_vendor %}
            <div class="vendor-badge mb-2">
              <span class="badge bg-light text-dark">{{ product.vendor }}</span>
            </div>
          {% endif %}
          
          <!-- Tour details if applicable -->
          {% if product.type contains 'Tour' or product.tags contains 'tour' or product.tags contains 'destination:' %}
            {% include 'extract-tour-data' with product %}
            {% include 'tour-card-details' %}
          {% endif %}
          
          <!-- Product description (truncated) -->
          <div class="product-description mt-2 mb-3 text-muted">
            {{ product.description | strip_html | truncatewords: 30 }}
          </div>
          
          <!-- Action button - always at bottom -->
          <div class="mt-auto d-flex">
            <a href="{{ product.url }}" class="btn btn-primary view-details-btn">View Details</a>
            
            {% if product.available %}
              <a href="{{ product.url }}" class="btn btn-outline-secondary ms-2">
                Add to Cart
              </a>
            {% else %}
              <button class="btn btn-outline-secondary ms-2" disabled>Sold Out</button>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .product-card {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    overflow: hidden;
  }
  
  .product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
  }
  
  .product-card-horizontal .image-container {
    height: 100%;
  }
  
  .product-card-horizontal .image-container img {
    height: 100%;
    object-fit: cover;
  }
  
  .product-card .image-container {
    position: relative;
    overflow: hidden;
  }
  
  .product-card .second-img {
    position: absolute;
    top: 0;
    left: 0;
    opacity: 0;
    transition: opacity 0.5s ease;
  }
  
  .product-card:hover .second-img {
    opacity: 1;
  }
  
  .product-card .card-title {
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
  }
  
  .product-card .card-title a {
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }
  
  .product-card .product-description {
    font-size: 0.9rem;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
  }
  
  /* Badges */
  .badge-new, .badge-sale {
    position: absolute;
    top: 10px;
    font-size: 0.75rem;
    padding: 4px 8px;
    font-weight: 500;
    z-index: 2;
  }
  
  .badge-new {
    background-color: #28a745;
    color: white;
    left: 10px;
  }
  
  .badge-sale {
    background-color: #dc3545;
    color: white;
    right: 10px;
  }
  
  /* Tour card details styling */
  .tour-card-details {
    margin-bottom: 10px;
  }
  
  /* View details button */
  .view-details-btn {
    transition: all 0.2s ease;
  }
  
  .view-details-btn:hover {
    transform: translateY(-2px);
  }
  
  /* Responsive adjustments */
  @media (max-width: 767px) {
    .product-card-horizontal .image-container {
      max-height: 200px;
    }
    
    .product-card-horizontal .card-body {
      padding-top: 1rem;
    }
  }
</style>
